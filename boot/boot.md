# Домашнее задание Работа с загрузчиком

### Описание/Пошаговая инструкция выполнения домашнего задания:
1. Попасть в систему без пароля несколькими способами.
2. Установить систему с LVM, после чего переименовать VG.
3. Добавить модуль в initrd. 
4. Сконфигурировать систему без отдельного раздела с /boot, 
а только с LVM Репозиторий с пропатченым grub: https://yum.rumyantsev.com/centos/7/x86_64/ PV 
необходимо инициализировать с параметром --bootloaderareasize 1m

### Решение:
### Задание 1.

Попасть в систему без пароля способ первый:
1. Перед началом загрузки CentOS нажимаем на клашиву ```e``` для входа в grub меню.
2. В строке ```linux16``` убираем ```console=tty0 console=ttyS0,115200n8``` и добавляем ```rd.break enforcing=0```, далее нажимаем ```Ctrl+X```.
3. Произойдет загрузка системы в аварийном режиме.
4. Далее выполняем команду перемонтирования корня для чтения и записи - ```mount -o remount,rw /sysroot```, далее ```chroot /sysroot```.
5. Выполняем команду ```passwd``` и меняем пароль для пользователя ```root```.
6. После смены пароля необходимо скрытый файл выполнив команду ```touch /.autorelabel```. Этот файл нужен, для того чтобы выполнить ```relabel``` файлов в системе, 
если ```selinux``` включен и находиться в режиме ```Enforcing```. Без этого вы не сможете залогиниться в систему после ее загрузки.
7. Перезагружаем систему, заходим под ```root```, введя измененный пароль.
8. Далее выполняем команду ```fixfiles -f relabel```, происходит ```relabeling``` файлов, ```selinux``` перечитывает файлы системы и начинаем им доверять.
9. После чего заходим в ```/etc/selinux/config``` и приводим строку к виду ```SELINUX=Enforcing```.
10. Далее можем перезагружаться и попробовать войти в систему.

Попасть в систему без пароля способ второй:
1. Перед началом загрузки CentOS нажимаем на клашиву ```e``` для входа в grub меню.
2. В строке ```linux16``` убираем ```console=tty0 console=ttyS0,115200n8``` и добавляем ```init=/bin/sh```, далее нажимаем ```Ctrl+X```.
3. Далее выполняем команду перемонтирования корня ```mount -o remount,rw /sysroot```.
4. Выполняем команду ```passwd``` и меняем пароль.
5. После чего заходим в ```/etc/selinux/config``` если ```SELINUX=Enforcing```, то меняем на ```Permissive``` или ```Disabled```.
6. после перезагрузки, если ```SELINUX``` включен, то делаем ```fixfilex -f relabel```

### Задание 2.
* После установки системы с LVM смотрим какие Volume Group у нас есть выполнив команду ```vgs```.
* переименовываем VG:
  * ```vgrename centos centos1```
* Чтобы в дальнейшем смогли загрузиться меняем старое название на новое в файлах:
  *  ```/etc/fstab```;
  *  ```/etc/default/grub``` и в строке ```GRUB_CMDLINE_LINUX``` в значениях ```rd.lvm.lv```;
  *  ```/boot/grub2/grub.cfg``` в строке ```linux16```.
* Далее пересоздаем ```initrd image``` чтобы в файлах поменялся путь монтирования. Выполняем ```mkinitrd -f -v /boot/initramfs-$(uname -r).img $(uname -r)```.
* Перезагружаем систему. Теперь система загружается с новым названием VG ```centos1```.

### Задание 3.
